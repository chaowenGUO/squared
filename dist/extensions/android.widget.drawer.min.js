this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.drawer=function(){"use strict";const{getElementAsNode:e}=squared.lib.session,{assignEmptyValue:t,capitalize:i,cloneObject:a,safeNestedMap:n,includes:o,iterateArray:r}=squared.lib.util,{createStyleAttribute:s,createViewAttribute:d}=android.lib.util,{NODE_RESOURCE:u,NODE_TEMPLATE:l}=squared.base.lib.enumeration,{EXT_ANDROID:c,SUPPORT_ANDROID:m,SUPPORT_ANDROID_X:p}=android.lib.constant,{BUILD_ANDROID:h,CONTAINER_NODE:N}=android.lib.enumeration,E=android.base.Resource;class Drawer extends squared.base.ExtensionUI{constructor(e,t,i,a){super(e,t,i,a),this.documentBase=true,this.require(c.EXTERNAL,true),this.require("android.widget.menu"),this.require("android.widget.coordinator")}init(e,t){var i;if(this.included(e)){const a=this.application;if(r(e.children,e=>{if("NAV"===e.tagName){const t=a.getDatasetName("use",e);if(!o(t,c.EXTERNAL))a.setDatasetName("use",e,(t?t+", ":"")+c.EXTERNAL)}})&&(null===(i=a.getProcessing(t))||void 0===i?void 0:i.rootElements.add(e)))return true}return false}processNode(e,i){const a=d(this.options.self);if(Drawer.findNestedElement(e,"android.widget.menu"))t(a,"android","fitsSystemWindows","true"),this.setStyleTheme(e.api);else{const i=d(this.options.navigationView);t(i,"android","layout_gravity",e.localizeString("left"));const a=e.item();a.mergeGravity("layout_gravity",i.android.layout_gravity),a.setLayoutHeight("match_parent"),a.positioned=true}e.documentRoot=true,e.renderExclude=false;const n=e.api<29?m.DRAWER:p.DRAWER;return e.setControlType(n,N.BLOCK),e.exclude({resource:u.FONT_STYLE}),e.apply(E.formatOptions(a,this.application.extensionManager.optionValueAsBoolean(c.RESOURCE_STRINGS,"numberResourceValue"))),e.render(i),e.setLayoutWidth("match_parent"),e.setLayoutHeight("match_parent"),{output:{type:1,node:e,controlName:n},complete:true,include:true,remove:true}}afterParseDocument(){var e,a;const o=i(this.application.systemName);for(const i of this.subscribers){const r=d(this.options.navigationView),s=null===(e=Drawer.findNestedElement(i,"android.widget.menu"))||void 0===e?void 0:e.dataset["layoutName"+o],u=null===(a=Drawer.findNestedElement(i,c.EXTERNAL))||void 0===a?void 0:a.dataset["layoutName"+o],l=n(r,"app");if(s)t(l,"menu","@menu/"+s);if(u)t(l,"headerLayout","@layout/"+u);if(s||u){const e=this.controller;t(r,"android","id",`@+id/${i.controlId}_navigation`),t(r,"android","fitsSystemWindows","true"),t(r,"android","layout_gravity",i.localizeString("left")),e.addAfterInsideTemplate(i.id,e.renderNodeStatic({controlName:i.api<29?m.NAVIGATION_VIEW:p.NAVIGATION_VIEW,width:"wrap_content",height:"match_parent"},E.formatOptions(r,this.application.extensionManager.optionValueAsBoolean(c.RESOURCE_STRINGS,"numberResourceValue"))))}}}postOptimize(t){const i=Drawer.findNestedElement(t,"android.widget.coordinator");if(i){const a=e(i,t.sessionId);if((null==a?void 0:a.inlineHeight)&&a.some(e=>e.positioned))a.setLayoutHeight("match_parent")}}setStyleTheme(e){const i=this.application.userSettings,n=s(this.options.resource);if(t(n,"name",i.manifestThemeName),t(n,"parent",i.manifestParentThemeName),t(n.items,"android:windowTranslucentStatus","true"),E.addTheme(n),e>=21){const e=s(a(n)),i={};t(e.output,"path","res/values-v21"),t(i,"android:windowDrawsSystemBarBackgrounds","true"),t(i,"android:statusBarColor","@android:color/transparent"),e.items=i,E.addTheme(e)}}}const g=new Drawer("android.widget.drawer",2);if(squared)squared.include(g);return g}();
